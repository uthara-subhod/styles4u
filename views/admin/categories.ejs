<%- include ('../layouts/adminheader.ejs') %>

  <div style="padding: 20px 20px 20px 20px;">
    <table class="table table-bordered bg-white">

      <thead>
        <tr>
          <th width="5%" class="text-center">sl.no</th>
          <th width="45%" class="text-center">Name</th>
          <th width="30%" class="text-center">Main Category</th>
          <th width="20%" class="text-center">Actions</th>
        </tr>
      </thead>
      <% for(let i=0;i<cat.length;i++){ %>
        <tr>
          <td class="text-center">
            <%=i+1+(page*5)-5%>
          </td>
          <td>
            <%if(cat[i].sub){%>
              <%=cat[i].sub%>
                <%}else{%>
                  <%=cat[i].name %>
                    <%}%>
          </td>
          <td>
            <%=cat[i].name %>
          </td>
          <td class="text-center">
            <a href="/admin/category/edit?name=<%=cat[i].name %><%if(cat[i].sub){%>&sub=<%=cat[i].sub%><%}%>"
              class="btn btn-primary px-4">Edit</a>
            <button type="button" style="background-color: rgb(122, 52, 52);" onclick="redirectToPage('<%=cat[i]._id%>', '<%=cat[i].name%>', '<%=cat[i].sub%>')" <% if
              (items[i]) { %>disabled<% } %> class="btn text-light">Delete</button>
            <script>
                function redirectToPage(id,name,sub) {
                  // Redirect to a specific page with the category ID
                  if(!sub){
                    window.location.href = `/admin/category/delete?id=${id}&name=${name}`;
                    }else{
                    window.location.href = `/admin/category/delete?id=${id}&name=${name}&sub=${sub}`
                    }
                  
                }
              </script>
          </td>
        </tr>
        <%}%>
    </table>
  </div>
  <div class="col-12 pb-1">
    <nav aria-label="Page navigation">
      <ul class="pagination justify-content-center">
        <% if (page> 1) { %>
          <li class="page-item">
            <a class="page-link" href="/admin/category?page=<%= page - 1 %>">&laquo; Previous</a>
          </li>
          <% } %>

            <% for (let i=1; i <=totalPages; i++) { %>
              <% if (i===page) { %>
                <li class="page-item active">
                  <a class="page-link" href="/admin/category?page=<%= i %>">
                    <%= i %>
                  </a>
                </li>
                <% } else { %>
                  <li class="page-item">
                    <a class="page-link" href="/admin/category?page=<%= i %>">
                      <%= i %>
                    </a>
                  </li>
                  <% } %>
                    <% } %>

                      <% if (page < totalPages) { %>
                        <li class="page-item">
                          <a class="page-link" href="/admin/category?page=<%= page + 1 %>">Next &raquo;</a>
                        </li>
                        <% } %>
      </ul>
    </nav>
  </div>

  <%- include ('../layouts/adminfooter.ejs') %>